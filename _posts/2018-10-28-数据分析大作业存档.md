---
title:	数据分析大作业过程存档
tags:	日志
---

> 俗话说得好，写不好文档/ReadMeFirst，那么code的时候是一定会有点什么问题的！

>

> 👆🏿俗话是我编的反正要写好文档就是了！这样交大写作业文档的时候也会方便许多呢！

## 想写什么

大概想写的是一个爬取豆瓣电影及评论，对评论中关键词进行特征提取，结合电影总的评分与爬取评论中的评分进行一个输入关键词吐出来推荐电影的这么一个电影推荐系统

## 实际上..

对评论进行关键词提取什么的也不是jieba分词那么简单就能做的..nlp现在还不太ok我太菜了..

最后变成了..对影评中的观众打分爬取，基于协同过滤的一个吐出来你想要的分数的电影推荐系统，交上去的大作业大概是这样子的..

当然这个学期结束前还是希望把这个东西写成最开始想要的电影推荐系统，不过一个类似于搜索引擎的电影推荐系统的搜索时间..结果吐出来的时间..感觉真的很吃算法呢，目前基于学长们以及已有的相关资料可以实现对评论进行分析..这个功能..所以最后要搞这样的推荐系统感觉还是有些难度的..并且需要一个很棒的用来计算的服务器呢！（说到服务器今天为了跑爬虫买了按需计费的华为云12核，还得重新配环境..然后发现我记录配环境的博客好像当时写的也不是很全..叹气） 扯远了 感觉我的博客向来都好啰嗦啊..

好了上面就是大概过程接下来要具体实现了呢！

## 实现起来..

首先爬数据的时候倒是很顺畅..使用的是requset+re匹配的这么个方法来匹配出电影的相关信息。

遇到的问题：

1. 由于编码问题，部分电影的部分信息网站中即使查看了源代码显示出来的信息也和爬到的信息不符合..编码原因导致比如说这部电影的title:

忠犬八公的故事 Hachi: A Dog's Tale 👈🏿网站中显示的是这样的，实际上我们匹配出来之后是这样的👉🏿
```
忠犬八公的故事 Hachi: A Dog&#39;s Tale
```
就很迷..直接比较来看的话是空格和's出现了问题呢..匹配的正则表达式是这样的
```
pattern = re.compile('<span property="v:itemreviewed">(.*)</span>')
 ```
实在是搞不懂搞不懂..

2. 文件存储的问题。由于这个代码中写了一个movie的class，class中定义了movie的相关信息，然后main.py中写的一个spider class，在class中执行具体的爬虫什么的，原本的文件存储方式是想直接存成csv保存在相对路径下，然而由于每次运行的时候都重新开一个spider的空间，因此上一个线程执行完的信息在下一个线程中就被清空了..努力的想加一个什么..global变量类似的东西，这样可以直接每个类执行完了都写入这个global里，然而..没成功。    后来又想着在movie这个class里动点手脚加个写入文件的函数，同样的因为每次执行函数，新建一个movie的时候，上一个保存的csv都会被覆盖..（除非我们写好多个csv..然而那样感觉会很爆炸..写1w个csv文件..emmme

上面的问题最后可能还是会屈服于数据库..或许还是会存到数据库里吧...然而不想Orz

（以及有点担心反复读写文件1w次20w次200w次会不会对我的SSD造成一些不可逆转的影响..因此可能是把代码放到服务器上跑2333333）

以上 暂时就这样？等我先存好数据写完协同过滤把大作业交上去再来更新一波？接下来就研究nlp就可以了？嗯我觉得不错..