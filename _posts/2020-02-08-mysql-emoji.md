---
title:	å­—ç¬¦ä¸²ä¸­çš„emojiæ’å…¥mysqlæ—¶å¼•å‘çš„é”™è¯¯âŒ
tags:	mysql
---

> å¾ˆå¤šæ¡emojiå¼•å‘çš„æ’å…¥é”™è¯¯çš„è¡€æ¡ˆï¼ˆä¸æ˜¯
>
> è¿™é‡Œè®°å½•ä¸€ä¸‹é¿å…ä»¥åè¸©å‘ã€‚mysqlçœŸçš„å¥½å¤šå‘ã€‚

## é—®é¢˜æè¿°

å½“æ•°æ®çš„å­—ç¬¦ä¸²ä¸­å«æœ‰emojiæ—¶ï¼Œåœ¨æˆ‘æƒ³æŠŠä»–æ’å…¥åˆ°mysqlæ•°æ®åº“ä¸­æ—¶ï¼Œå‘ç°æŠ¥é”™æ’ä¸è¿›å»ï¼Œå¯¼è‡´æ•°æ®å°‘äº†ä¸€äº›ã€‚debugçš„è¿‡ç¨‹æ’æŸ¥çš„ææ…Œä»”ç»†å®¡è§†ä¿ºçš„çˆ¬è™«ç­‰è¿‡ç¨‹å°±ç•¥å»ä¸è¯´äº†ã€‚

æœ€ç»ˆå¾—åˆ°çš„ç»“è®ºï¼šemojiçš„ç¼–ç æ ¼å¼å’Œæ•°æ®åº“é‡Œçš„ç¼–ç æ ¼å¼ä¸ç›¸ç¬¦æ‰€ä»¥æ’ä¸è¿›å»ï¼ˆåºŸè¯ï¼‰emojiæ˜¯`utf8mb4` æ•°æ®åº“é‡Œæ˜¯`utf8`æ ¼å¼ï¼ˆåº”è¯¥å§ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“ã€‚è¿˜æ˜¯è¯´character_set_serverçš„ç¼–ç æ ¼å¼æ˜¯utf8ï¼Œè¡¨ä¸­çš„ç¼–ç ä¸ºutf6mb4æ‰€ä»¥æ’ä¸è¿›å»..æ€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„ï¼‰

## è§£å†³æ–¹æ¡ˆ

æ‘†åœ¨çœ¼å‰çš„è§£å†³æ–¹æ¡ˆå…¶å®ä¹Ÿå¾ˆå¥½æƒ³ï¼Œæœ‰ä¸¤ä¸ªï¼š

1. å°†çˆ¬å¥½çš„å«emojiçš„æ•°æ®è½¬æˆutf8å†™å…¥æ•°æ®åº“ï¼Œåœ¨å°†æ•°æ®ä»æ•°æ®åº“ä¸­å¯¼å‡ºä¸ºcsvæ—¶å†è¿›è¡Œä¸€ä¸ªè½¬æ¢ğŸ¤”

2. å°†æ•°æ®åº“çš„å­—ç¬¦ç¼–ç æ ¼å¼ä¿®æ”¹ä¸€ä¸‹ï¼Œä»`utf8`->`utf8mb4`(è¿™é‡Œè¡¨è¿°çš„å¯èƒ½æœ‰äº›ä¸å‡†ç¡®

è¿™ä¸ªä»£ç ä¹‹åè¿˜è¦è¿è¡Œåœ¨æœ‹å‹çš„PCä¸Šï¼Œè€ƒè™‘åˆ°è¿™ä¸ªå…¶å®æ–¹æ¡ˆ1åº”è¯¥æœ€åˆé€‚ï¼ˆä½†æ˜¯çœ‹èµ·æ¥å¥½åƒæœ‰ç‚¹å¤æ‚å‘¢ã€‚æ–¹æ¡ˆ2å¥½åƒç›´æ¥ä¿®æ”¹æ•°æ®åº“é…ç½®å°±å¯ä»¥äº†å‘€ã€‚ï¼‰é‚£ä¹ˆä¸¤ä¸ªéƒ½è¯•ä¸€è¯•å§ã€‚

### æ–¹æ¡ˆäºŒï¼šæ”¹æ•°æ®åº“ç¼–ç 

> æˆ‘è®°å¾—æˆ‘çš„mysqlå®‰è£…æ˜¯homebrewå®‰è£…çš„ï¼Œä½†ä¸ç®¡æ€ä¹ˆè£…ä¹‹å‰éƒ½æ²¡æœ‰æŸ¥çœ‹è¿‡é…ç½®æ–‡ä»¶ã€‚è€Œä¸”ä¹‹å‰æ²¡ç”¨è¿‡é…ç½®æ–‡ä»¶æ‰€ä»¥ç”µè„‘é‡Œæ˜¯ç»å¯¹æ²¡æœ‰è¿™ä¸ªcnfçš„ã€‚éš¾æå“¦ã€‚

é¦–å…ˆç”¨å‘½ä»¤æŸ¥çœ‹`my.cnf`çš„ä½ç½®

```
192:~ xusy$ mysql --verbose --help | grep my.cnf
                      order of preference, my.cnf, $MYSQL_TCP_PORT,
/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf 
192:~ xusy$ 
```
å¯ä»¥çœ‹åˆ°ç”µè„‘é‡Œæœ‰ä¸‰ä¸ªä½ç½®ï¼Œä½†æ˜¯ä¹‹å‰æ ¹æœ¬æ²¡ç”¨è¿‡é…ç½®æ–‡ä»¶å› æ­¤ç”µè„‘é‡Œä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ°[è¿™é‡Œ](https://www.fromdual.com/mysql-configuration-file-sample)ä¸‹è½½åˆ°è¿™ä¸ªé…ç½®æ–‡ä»¶ã€‚ä¹‹å

```
cd /etc
sudo vi my.cnf
```
åˆ›å»ºmy.cnfä¹‹åæŠŠåˆšåˆšçš„é…ç½®æ–‡ä»¶å¤åˆ¶è¿‡æ¥å°±å¯ä»¥äº†ã€‚

ç´§æ¥ç€åœ¨åˆšåˆšçš„é…ç½®æ–‡ä»¶ä¸­æŠŠä¸‹é¢è¿™ä¸ªæ³¨é‡Šè§£é™¤æ‰å°±å¯ä»¥äº†
```
# character_set_server           = utf8mb4                             # For modern applications, default in MySQL 8.0
```
ä¹‹åé‡å¯mysql
```
brew services restart mysql
```

è¿™æ ·é€šè¿‡ä¿®æ”¹æ•°æ®åº“çš„å­—ç¬¦ç¼–ç æ ¼å¼å°±å¯ä»¥å°†emojiæ’å…¥åˆ°æ•°æ®åº“ä¸­äº†ã€‚è§£å†³äº†è§£å†³äº†ï¼ï¼ï¼

> ä½†æ˜¯ä¿ºçš„å°å…„å¼Ÿä¹‹åè¦åœ¨PCä¸Šè·‘è¿™ä¸ªä»£ç å‘€ï¼Œå°å…„å¼Ÿå¹¶ä¸æ˜¯CSä¸“ä¸šçš„ç”µè„‘ä¸Šè¿mysqlä¹Ÿæ²¡è£…ï¼Œæ›´åˆ«ææ”¹æ•°æ®åº“è®¾ç½®å•¦ï¼è€Œä¸”ç”µè„‘ç¯å¢ƒä¹Ÿä¸ä¸€æ ·è¿™ç¯‡åšå®¢å°å…„å¼Ÿä¹Ÿå‚è€ƒä¸äº†ã€‚é‚£ä¹ˆå°±è¯•è¯•ç¬¬äºŒä¸ªæ–¹æ³•å§ï¼

### æ–¹æ³•ä¸€ï¼šå°†emojiçš„ç¼–ç è½¬æ¢æˆutf8åå†™å…¥ï¼Œå¯¼å‡ºæ—¶å†è½¬å›å»

ç®—äº†emojiçš„ç¼–ç è½¬æ¢å¥½åƒå¾ˆéº»çƒ¦ç®—äº†ç®—äº†ã€‚å…ˆè¿™æ ·å§ã€‚

> PSï¼šè®°å½•ä¸€ä¸‹homebrewå®‰è£…çš„mysqlçš„å¯åŠ¨ã€é‡å¯ã€è¿›å…¥ç­‰çš„å‘½ä»¤ã€‚
```
# å¯åŠ¨ mysql, å¹¶è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨
brew services start mysql
# å…³é—­ mysql
brew services stop mysql
# é‡å¯ mysql
brew services restart mysql
# è¿›å…¥mysql
192:~ xusy$ mysql -uroot -p
```