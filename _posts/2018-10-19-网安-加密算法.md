---
title:	网络信息安全（一）加密算法
tags:	网络信息安全 
---

> 要考试了我瞎几把随便预习的..就放上来存个档吧！

- 对称密码：加密密钥和解密密钥相同，开放性差
- 非对称密码：加密密钥和解密密钥不同，开放性好


### Caesar密码：代替加密

明文字母代替成字母表中后第k个字母变成密文字母C

**加密算法：**C=E(k,p)=(p+k)mod26

**解密算法：**p=D(k,C)=(C-k)mod26

Caesar密码非常不安全：

1. 大家都知道，已知加密和解密算法

2. 密钥空间较小只有25个

3. 明文所用语言已知的比较好识别（英文）

### 单表代替密码：置换加密

**置换加密：**就是将明文中字母用密码表中对应查表得到的对应密文字母进行置换

**单表代替密码**就是说只有一张密码表的置换加密。密码表在设计的时候一共有26！这么多种可能（因为A对应的选择有26种，B有25种，以此类推就有26！这么多）这个密钥长度就有26！这么大，经过计算是👉403291461126605635584000000这么大！这就比4x10^26种可能的密钥要大，看起来可以抵挡穷举攻击了！

单表替代密码的每条消息用一个字母表进行加密。

**攻击方法：**密码分析者知道明文的属性（如未经压缩的英文）就可以利用一些语言规律进行攻击。

常见的是利用字母的使用频率与密文中统计得出的字母使用相对频率进行比较，接下来尝试进行一些代替，填入明文，观察是否像一条消息。

当出现的消息频率比较容易让人产生迷惑时（比如说某两个字母频率比较接近，或者说密文中A可能对应w,b,e,x等多个字母时，就需要一点时间进行尝试。

统计双字母组合频率这里也非常常用。使用字母频率确定某两个字母对应什么明文字母之后，利用字母频率进行替换就比较好办啦！


单表代替密码也比较容易被攻破：带有原始字母使用频率的一些统计学特征。可以将一个明文单元提供多个字母进行代替，但这种情况双字母频率仍然非常有效。可以使用（1）对明文中多字母一起加密；（2）采用多表代替密码； 减少代替密码里明文结构在密文的残留度。

### Playfair密码 ：多字母代替密码

playfair密码是最著名的多字母代替密码，它把明文中的双字母音节作为一个单元并将其转换为密文的双字母音节。

playfari基于一个由密钥词构成的5x5字母矩阵，具体例子见书P30，百度百科的[这个链接](https://baike.baidu.com/item/playfair密码/8999814?fr=aladdin)讲的就很好了!

### Hill密码：多表代替

就是先将明文中字母转化为字母表中对应数字（或者ascii码表我觉得应该也行），然后将数字写成矩阵，根据约定的密钥空间大小，写成对应的3x4或者什么样的矩阵都行(如果密钥是3x3的矩阵那么写成一个mx3的就可以，方便我们做矩阵乘法)。

**加密算法：** C=E(K,P)=PKmod(26)

**解密算法：** P=D(K,C)=CK^-1mod(26)=PKK^-1

> 这里在解密的时候涉及到求加密密钥的可逆矩阵K^-1,为线性代数部分的知识，让我们一起来回忆一下！
> 已知矩阵A，我们在求矩阵的可逆矩阵时，首先求A的行列式det(A)，如果det(A)=0则说明矩阵不可逆; det(A)!=0: 接下来求A\*这个矩阵: （具体叫啥我忘记了..过程是这样的:(想起来了！是叫代数余子式!)
> 
> 先求A的转置A^T (好像我的网站里还不支持数学公式的显示和latex语法..🤔)，接下来对A^T求代数余子式(就是对A^T 的每个元素aij,计算去掉i行j列的det,然后乘上(-1)^i+j就完事了)，最后用刚刚求出来的代数余子式，除A的行列式，得到的结果就是A的逆A-1

我们举个例子：

明文为：pay more money 加密密钥：
```
K=(17 17 5
   21 18 21
   2  2  19)
```
明文前三个字母用向量(15 0 24)表示，剩下的以此类推，(15 0 24)K=(303 303 531)mod26=(17 17 11)=RRL，按照这个方式转换剩下的字母就完事了！得到的密文：RRLMWBKASPDH

解密需要用到K逆
```
K-1=(4  9  15 
     15 17 6
     24 0 17)
```
验证两个矩阵乘法：
```
17 17 5   4 9 15   = 443 442 442        1 0 0

21 18 21  15 17 6    858 495 780 mod26= 0 1 0

2 2 19    24 0 17    494 52 365         0 0 1
```
大概就是验证一下我们求出来的K K-1 没有问题 乘积是个单位矩阵的意思～ （啊不支持数学公式显示真的好麻烦！摔！等我改改config文件！摔！

**值得注意的是：** Hill密码的优点是完全隐蔽了单字母的频率特性（实际上用的矩阵越大隐藏的频率信息就越多！）Hill比较能抵抗唯密文攻击，但是已知明文攻击就比较容易了！因为我们可以先用一对对应的明文密文矩阵计算得到K，具体的计算过程我觉得聪明的你一定可以想到！(想不到就看看书P33.. 道理很简单..然后计算得到的这个K就可以使用其他明文密文矩阵对来演算一下就能知道对不对了..就被破解了...


### 多表代替加密

> 首先一般啥时候用多表代替加密呢！
> 
> 多表代替加密就是对单表加密的一个改进，改进的方法就是在明文消息中采用不同的单表代替，一般采用相关的单表代替规则集；密钥决定给定变化的具体规则。

#### Vigenere密码

简单来说可以理解成一个针对一条明文，每个字母都使用密钥中对应的一个字母进行caesar加密的这么一个方法，要是写成一个26x26的表就是一个多表了，就可以查阅了！

网上能找到的[这个PPT讲的就很好（我校PPT里没找到..](https://wenku.baidu.com/view/db3d11fe941ea76e58fa04cf.html)

明文序列：P=p0 p1 p2 ... pn-1

密钥序列：K=k0 k1 k2 ... km-1

**加密方程：** Ci=(pi + k imodm)mod26

**解密方程：** Pi=(ci - k imodm)mod26

Vigenere密码尽管字母出现的频率信息被隐蔽了，但仍然保留了许多频率信息。破译相关内容参照课本P35

#### Vernam密码(在下面的一次一密中被改进了..这里就不介绍了)


### 一次一密

Joseph Mauborgne提出使用与消息一样长且无重复的随机密钥来加密消息，密钥只对一个消息加解密，之后弃之不用；每条新消息都需要与其等长的新密钥，这就是一次一密，它是不可攻破的。

![一次一密](/img/一次一密.png)

给出任何长度与密文一样的明文，都存在着一个密钥产生这个明文。如果用穷举法搜索所有可能的密钥，会得到大量可读、清楚的明文，但是无法确定哪个才是真正所需的，因而这种密码不可破。

一次一密的两个限制：

- 产生大规模随机密钥有实际困难

- 密钥的分配和保护无法保证: 每发送一条消息都要提供给发送方和接收方等长的密钥..因此存在巨大的密钥分配问题

实际上一次一密的安全性完全取决于密钥的随机性

让我们举个例子吧：

假设我们使用27个字符的Vigenere密码（第27个为空格）

密文：ANKYODKYUREPFJBYOJDSPLREYIUNOFDOIUERFPLUYTS

进行两种不同的密钥解密：

密文：ANKYODKYUREPFJBYOJDSPLREYIUNOFDOIUERFPLUYTS

密钥：pxlmvmsydoftyrvzwc tnlebnecvgdupahfzzlmnyih

明文：mr mustard with the candlestick in the hall

密文：ANKYODKYUREPFJBYOJDSPLREYIUNOFDOIUERFPLUYTS

密钥：mufugpmiydgaxgoufhklllmhsqdqogtewbqfgyovuhwt

明文：miss scarlet with the knife in the library

### 置换技术

> 上述密码都是代替加密的，即将明文字母代替为密文字母；而置换技术是对明文进行置换

#### 栅栏技术：置换技术的一个最简单小🌰

按照对角线顺序写出明文，按行的顺序读出作为密文。如用深度为2的栅栏技术加密:

meet me after the toga party

可写为：

m e m a t r h t g p r y

e t e f e t e o a a t

加密后为：MEMATRHTGPRYETEFETEOAAT

经验丰富的密码分析者朋友很容易就看出来你这个东西啦！而且这样加密之后...字母频率完全没发生变化很容易想出来呀！那么怎么办呢！更复杂的方案来了！👇🏿

把消息一行一行地写成矩形块，然后按列读出，**但是！！！！**把列的次序打乱，列的次序就是算法的密钥,如：
```
密钥：4 3 1 2 5 6 7

明文：a t t a c k p
    
     o s t p o n e

     d u n t i l t

     w o a m x y z

密文：TTNAAPTMTSUOAODWCOIXKNLYPETZ
```
但其实..仍旧很不安全..

单纯的置换密码因为有着与原始明文相同的字母频率特征而容易被识别，即使做了列变换的密码，也可以通过双音节，三音节频率表分析破解。

#### 多次置换密码：比上面的安全！

多次置换就是把上面的那个消息使用相同的算法再加密一次！
```
密钥：4 3 1 2 5 6 7

明文：t t n a a p t

     m t s u o a o

     d w c o i x k

     n l y p e t z

密文：NSCYAUOPTTWLTMDNAOIEPAXTTOKZ
```
二次加密之后的排列结构几乎没什么规律了..不错不错!

### 轮转机

感觉就是一个叠了好多层的单表代换？书上有个图..但是我没太看懂Orz（等我看懂了再来更新这部分！

### 隐写术

比较简单就不具体介绍了

> 本系列博客大概会是..随着期末复习进行的网络信息安全系列博文！（于是那样会不会显着博客列表太多了啊..如果博客列表太多了..我就..我也不知道怎么办反正想办法让网络信息安全系列不这么多好了Orz

>
> 今天先到这里咯！下次再见！任何问题欢迎下方留言👏（或联系wx:xsy9915/mail:xu_sy11111@mail.dlut.edu.cn









